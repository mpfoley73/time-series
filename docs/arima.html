<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 ARIMA | Time Series Analysis</title>
  <meta name="description" content="Time series analysis using R." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 ARIMA | Time Series Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Time series analysis using R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 ARIMA | Time Series Analysis" />
  
  <meta name="twitter:description" content="Time series analysis using R." />
  

<meta name="author" content="Michael Foley" />


<meta name="date" content="2023-09-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exponential.html"/>
<link rel="next" href="dynamic.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series Analysis in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="toolbox.html"><a href="toolbox.html"><i class="fa fa-check"></i><b>1</b> Basics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="toolbox.html"><a href="toolbox.html#common-frameworks"><i class="fa fa-check"></i><b>1.1</b> Common Frameworks</a></li>
<li class="chapter" data-level="1.2" data-path="toolbox.html"><a href="toolbox.html#fitting-models"><i class="fa fa-check"></i><b>1.2</b> Fitting Models</a></li>
<li class="chapter" data-level="1.3" data-path="toolbox.html"><a href="toolbox.html#evaluating-fit"><i class="fa fa-check"></i><b>1.3</b> Evaluating Fit</a></li>
<li class="chapter" data-level="1.4" data-path="toolbox.html"><a href="toolbox.html#evaluating-accuracy"><i class="fa fa-check"></i><b>1.4</b> Evaluating Accuracy</a></li>
<li class="chapter" data-level="1.5" data-path="toolbox.html"><a href="toolbox.html#model-selection"><i class="fa fa-check"></i><b>1.5</b> Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exploration.html"><a href="exploration.html"><i class="fa fa-check"></i><b>2</b> Exploratory Analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="exploration.html"><a href="exploration.html#graphical-analysis"><i class="fa fa-check"></i><b>2.1</b> Graphical Analysis</a></li>
<li class="chapter" data-level="2.2" data-path="exploration.html"><a href="exploration.html#transformations"><i class="fa fa-check"></i><b>2.2</b> Transformations</a></li>
<li class="chapter" data-level="2.3" data-path="exploration.html"><a href="exploration.html#decomposition"><i class="fa fa-check"></i><b>2.3</b> Decomposition</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="exploration.html"><a href="exploration.html#classical-decomposition"><i class="fa fa-check"></i><b>2.3.1</b> Classical Decomposition</a></li>
<li class="chapter" data-level="2.3.2" data-path="exploration.html"><a href="exploration.html#x-11-and-seats"><i class="fa fa-check"></i><b>2.3.2</b> X-11 and SEATS</a></li>
<li class="chapter" data-level="2.3.3" data-path="exploration.html"><a href="exploration.html#stl"><i class="fa fa-check"></i><b>2.3.3</b> STL</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>3</b> Time Series Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="regression.html"><a href="regression.html#exploratory-analysis"><i class="fa fa-check"></i><b>3.1</b> Exploratory Analysis</a></li>
<li class="chapter" data-level="3.2" data-path="regression.html"><a href="regression.html#fit-model"><i class="fa fa-check"></i><b>3.2</b> Fit Model</a>
<ul>
<li class="chapter" data-level="" data-path="regression.html"><a href="regression.html#special-predictors"><i class="fa fa-check"></i>Special Predictors</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="regression.html"><a href="regression.html#model-evaluation"><i class="fa fa-check"></i><b>3.3</b> Model Evaluation</a>
<ul>
<li class="chapter" data-level="" data-path="regression.html"><a href="regression.html#outliers-leverage-points-and-influential-points"><i class="fa fa-check"></i>Outliers, Leverage Points, and Influential Points</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="regression.html"><a href="regression.html#variable-selection"><i class="fa fa-check"></i><b>3.4</b> Variable Selection</a></li>
<li class="chapter" data-level="3.5" data-path="regression.html"><a href="regression.html#predicting-values"><i class="fa fa-check"></i><b>3.5</b> Predicting Values</a></li>
<li class="chapter" data-level="3.6" data-path="regression.html"><a href="regression.html#nonlinear-regression"><i class="fa fa-check"></i><b>3.6</b> Nonlinear Regression</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exponential.html"><a href="exponential.html"><i class="fa fa-check"></i><b>4</b> Exponential Smoothing (ETS)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exponential.html"><a href="exponential.html#simple-exponential-smoothing-ses"><i class="fa fa-check"></i><b>4.1</b> Simple Exponential Smoothing (SES)</a></li>
<li class="chapter" data-level="4.2" data-path="exponential.html"><a href="exponential.html#holt-linear"><i class="fa fa-check"></i><b>4.2</b> Holt Linear</a></li>
<li class="chapter" data-level="4.3" data-path="exponential.html"><a href="exponential.html#additive-damped-trend"><i class="fa fa-check"></i><b>4.3</b> Additive Damped Trend</a></li>
<li class="chapter" data-level="4.4" data-path="exponential.html"><a href="exponential.html#holt-winters"><i class="fa fa-check"></i><b>4.4</b> Holt-Winters</a></li>
<li class="chapter" data-level="4.5" data-path="exponential.html"><a href="exponential.html#auto-fitting"><i class="fa fa-check"></i><b>4.5</b> Auto-fitting</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="arima.html"><a href="arima.html"><i class="fa fa-check"></i><b>5</b> ARIMA</a>
<ul>
<li class="chapter" data-level="5.1" data-path="arima.html"><a href="arima.html#tranformations-and-differencing"><i class="fa fa-check"></i><b>5.1</b> Tranformations and Differencing</a></li>
<li class="chapter" data-level="5.2" data-path="arima.html"><a href="arima.html#autoregressive-models"><i class="fa fa-check"></i><b>5.2</b> Autoregressive Models</a></li>
<li class="chapter" data-level="5.3" data-path="arima.html"><a href="arima.html#moving-average-models"><i class="fa fa-check"></i><b>5.3</b> Moving Average Models</a></li>
<li class="chapter" data-level="5.4" data-path="arima.html"><a href="arima.html#non-seasonal-arima"><i class="fa fa-check"></i><b>5.4</b> Non-Seasonal ARIMA</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dynamic.html"><a href="dynamic.html"><i class="fa fa-check"></i><b>6</b> Dynamic Harmonic Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="dynamic.html"><a href="dynamic.html#tbats-model"><i class="fa fa-check"></i><b>6.1</b> TBATS Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Time Series Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="arima" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> ARIMA<a href="arima.html#arima" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Whereas exponential smoothing models describe the trend and seasonality, ARIMA models describe the autocorrelations.</p>
<p>An <strong>autoregressive</strong> (AR(<em>p</em>)) model is a multiple regression with <em>p</em> <em>lagged observations</em> as predictors.</p>
<p><span class="math display">\[y_t = c + \phi_1 y_{t-1} + \phi_2 y_{t-2} + \dots + \phi_p y_{t-p} + \epsilon_t\]</span></p>
<p>A <strong>moving average</strong> (MA(<em>q</em>)) model is a multiple regression with <em>q</em> <em>lagged errors</em> as predictors.</p>
<p><span class="math display">\[y_t = c + \epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \dots + \theta_p \epsilon_{t-q}\]</span></p>
<p>An <strong>autoregressive moving average</strong> (ARMA(<em>p</em>, <em>q</em>)) model is a multiple regression with <em>p</em> <em>lagged observations and q lagged errors</em> as predictors.</p>
<p><span class="math display">\[y_t = c + \phi_1 y_{t-1} + \dots + \phi_p y_{t-p} + \theta_1 y_{t-1} + \dots + \theta_p y_{t-q} + \epsilon_t\]</span></p>
<p>An <strong>ARMA model with differencing</strong> (ARIMA(<em>p,d,q</em>)) model is an ARMA model with <em>d</em> levels of differencing.</p>
<p>Whereas exponential smoothing models can handle non-constant variance with multiplicative errors and seasonality, autoregressive models require that you explicitly transform the data into a <em>stationary</em> time series with constant variance. A stationary time series is one in whose statistical properties do not depend on the time at which the series is observed. Stationary time series can have patterns, but no regular long term patterns.</p>
<div id="tranformations-and-differencing" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Tranformations and Differencing<a href="arima.html#tranformations-and-differencing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first step in any modeling exercise is plotting the data to identify unusual observations and non-constant variance. Let’s work through the process with the <code>fpp::usmelec</code> data set of us monthly electricity generation. You can see in Figure <a href="arima.html#fig:elec">5.1</a> that this data has non-constant variance.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="arima.html#cb98-1" tabindex="-1"></a>elec <span class="ot">&lt;-</span> fpp<span class="sc">::</span>usmelec <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="arima.html#cb98-2" tabindex="-1"></a>  <span class="fu">as_tsibble</span>() </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:elec"></span>
<img src="time-series_files/figure-html/elec-1.png" alt="This data series has non-constant variance." width="672" />
<p class="caption">
Figure 5.1: This data series has non-constant variance.
</p>
</div>
<p>There are an infinite number of transformations, but the common ones (in increasing strength) are: square root, cube root, log, and inverse. In Figure <a href="arima.html#fig:xform">5.2</a>, the square root, cube root, and log transformations are not quite strong enough to even out the error variance, but the inverse transformation is a little too large. We need a transformation somewhere in between.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="arima.html#cb99-1" tabindex="-1"></a>elec <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="arima.html#cb99-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sqrt =</span> <span class="fu">sqrt</span>(value), <span class="at">cubert =</span> value<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="at">log =</span> <span class="fu">log</span>(value), <span class="at">inverse =</span> <span class="dv">1</span><span class="sc">/</span>value) <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="arima.html#cb99-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>index) <span class="sc">%&gt;%</span></span>
<span id="cb99-4"><a href="arima.html#cb99-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb99-5"><a href="arima.html#cb99-5" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">factor</span>(</span>
<span id="cb99-6"><a href="arima.html#cb99-6" tabindex="-1"></a>      name, </span>
<span id="cb99-7"><a href="arima.html#cb99-7" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;value&quot;</span>, <span class="st">&quot;sqrt&quot;</span>, <span class="st">&quot;cubert&quot;</span>, <span class="st">&quot;log&quot;</span>, <span class="st">&quot;inverse&quot;</span>),</span>
<span id="cb99-8"><a href="arima.html#cb99-8" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;y&quot;</span>, <span class="st">&quot;sqrt(y)&quot;</span>, <span class="st">&quot;cubrt(y)&quot;</span>, <span class="st">&quot;log(y)&quot;</span>, <span class="st">&quot;1 / y&quot;</span>)</span>
<span id="cb99-9"><a href="arima.html#cb99-9" tabindex="-1"></a>    )</span>
<span id="cb99-10"><a href="arima.html#cb99-10" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb99-11"><a href="arima.html#cb99-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> index, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb99-12"><a href="arima.html#cb99-12" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb99-13"><a href="arima.html#cb99-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(name), <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb99-14"><a href="arima.html#cb99-14" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb99-15"><a href="arima.html#cb99-15" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb99-16"><a href="arima.html#cb99-16" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;US monthly electricity generation with standard transformations.&quot;</span>, </span>
<span id="cb99-17"><a href="arima.html#cb99-17" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:xform"></span>
<img src="time-series_files/figure-html/xform-1.png" alt="Standard transformations under- or over-shoot constant variance." width="672" />
<p class="caption">
Figure 5.2: Standard transformations under- or over-shoot constant variance.
</p>
</div>
<p>The Box-Cox transformation can find the optimal transformation (Figure <a href="arima.html#fig:boxcox">5.3</a>).</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="arima.html#cb100-1" tabindex="-1"></a>(lambda <span class="ot">&lt;-</span> elec <span class="sc">%&gt;%</span> </span>
<span id="cb100-2"><a href="arima.html#cb100-2" tabindex="-1"></a>   <span class="fu">features</span>(value, <span class="at">features =</span> guerrero) <span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="arima.html#cb100-3" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero))</span>
<span id="cb100-4"><a href="arima.html#cb100-4" tabindex="-1"></a><span class="do">## [1] -0.4772531</span></span>
<span id="cb100-5"><a href="arima.html#cb100-5" tabindex="-1"></a></span>
<span id="cb100-6"><a href="arima.html#cb100-6" tabindex="-1"></a>elec2 <span class="ot">&lt;-</span> elec <span class="sc">%&gt;%</span></span>
<span id="cb100-7"><a href="arima.html#cb100-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">box_cox</span>(value, lambda))</span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="arima.html#cb101-1" tabindex="-1"></a>elec2 <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="arima.html#cb101-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> index, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb101-3"><a href="arima.html#cb101-3" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb101-4"><a href="arima.html#cb101-4" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb101-5"><a href="arima.html#cb101-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">glue</span>(<span class="st">&quot;US monthly electricity generation with lambda = {scales::number(lambda, accuracy = .001)} Box-Cox transformation.&quot;</span>), <span class="at">x =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:boxcox"></span>
<img src="time-series_files/figure-html/boxcox-1.png" alt="Box-Cox transformation produces constant variance." width="672" />
<p class="caption">
Figure 5.3: Box-Cox transformation produces constant variance.
</p>
</div>
<p>After transforming the response variable, use differencing of successive observations to stabilize the level. In the case of seasonal data, take a seasonal difference (for monthly data, that means take the 12 observation difference), then possibly take a second one-observation difference (Figure <a href="#fig:differencing"><strong>??</strong></a>).</p>
<p><img src="time-series_files/figure-html/differencing-1.png" width="672" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="arima.html#cb102-1" tabindex="-1"></a>elec3 <span class="ot">&lt;-</span> elec2 <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="arima.html#cb102-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">difference</span>(value, <span class="dv">12</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb102-3"><a href="arima.html#cb102-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">difference</span>(value, <span class="dv">1</span>))</span>
<span id="cb102-4"><a href="arima.html#cb102-4" tabindex="-1"></a></span>
<span id="cb102-5"><a href="arima.html#cb102-5" tabindex="-1"></a>(elec_jung <span class="ot">&lt;-</span> elec3 <span class="sc">%&gt;%</span> <span class="fu">features</span>(value, ljung_box, <span class="at">lag =</span> <span class="dv">10</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   lb_stat lb_pvalue
##     &lt;dbl&gt;     &lt;dbl&gt;
## 1    72.9  1.20e-11</code></pre>
<p>The ACF of the twice-differenced values is white noise (Ljung-Box Q = 72.94, <em>p</em> = 0.000).</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="arima.html#cb104-1" tabindex="-1"></a>elec3 <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="arima.html#cb104-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> index, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb104-3"><a href="arima.html#cb104-3" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb104-4"><a href="arima.html#cb104-4" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb104-5"><a href="arima.html#cb104-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">glue</span>(<span class="st">&quot;US monthly electricity generation with Box-Cox and differencing.&quot;</span>), <span class="at">x =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 13 rows containing missing values (`geom_line()`).</code></pre>
<div class="figure">
<img src="time-series_files/figure-html/xform_and_diff-1.png" alt="Box-Cox transformation plus double-differencing produces stationary time series with constant variance." width="672" />
<p class="caption">
(#fig:xform_and_diff)Box-Cox transformation plus double-differencing produces stationary time series with constant variance.
</p>
</div>
<p>R function <code>auto.arima()</code> from the <code>forecast</code> package chooses the optimal ARIMA model parameters using the Akaike criterion.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></p>
<p>Use a unit root test to verify stationarity.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="arima.html#cb106-1" tabindex="-1"></a>(elec3_unitroot <span class="ot">&lt;-</span> elec3 <span class="sc">%&gt;%</span></span>
<span id="cb106-2"><a href="arima.html#cb106-2" tabindex="-1"></a>  <span class="fu">features</span>(value, unitroot_kpss))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   kpss_stat kpss_pvalue
##       &lt;dbl&gt;       &lt;dbl&gt;
## 1    0.0159         0.1</code></pre>
<p>The <em>p</em>-value is reported as .1 if it is greater than .1. In this case the test statistic of 0.0159 is smaller than the 1% critical value so the <em>p</em>-value is greater than .1. The null hypothesis is not rejected, meaning the data is assumed stationary.</p>
</div>
<div id="autoregressive-models" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Autoregressive Models<a href="arima.html#autoregressive-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Autoregressive models forecast the response variable as a function of past observations.</p>
<p><span class="math display">\[y_t = c + \phi_1 y_{t-1} + \phi_2 y_{t-2} + \dots + \phi_p y_{t-p} + \epsilon_t\]</span></p>
<p>where <em>p</em> is the order of regression. The model is denoted AR(<em>p</em>). For an AR(1) model, a <span class="math inline">\(\phi_1\)</span> = 0 and <em>c</em> = 0 would be the equivalent to white noise. If <span class="math inline">\(\phi_1\)</span> was 1, then the model would be a random walk. If <span class="math inline">\(phi_1\)</span> was 1 and <em>c</em> was non-zero then the model would be random walk with drift.</p>
</div>
<div id="moving-average-models" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Moving Average Models<a href="arima.html#moving-average-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A <strong>moving average</strong> (MA(<em>q</em>)) model is a multiple regression with <em>q</em> <em>lagged errors</em> as predictors.</p>
<p><span class="math display">\[y_t = c + \epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \dots + \theta_p \epsilon_{t-q}\]</span></p>
<p>where <span class="math inline">\(\epsilon_t\)</span> is white noise and <em>q</em> is the order of the regression. The model is denoted AR(<em>q</em>).</p>
</div>
<div id="non-seasonal-arima" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Non-Seasonal ARIMA<a href="arima.html#non-seasonal-arima" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you combine differencing with the AR and MA model, you get a non-seasonal ARIMA model (autoregressive integrated moving average) (in this context integration is the opposite of differencing).</p>
<p><span class="math display">\[y&#39;_t = c + \phi_1 y&#39;_{t-1} + \dots + \phi_p y&#39;_{t-p} + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \dots + \theta_p \epsilon_{t-q} + \epsilon_t\]</span></p>
<p>where <span class="math inline">\(y&#39;_t\)</span> is the differenced series (possibly multiple differences) and <em>d</em> is the order of differencing. The model is denoted ARIMA(<em>p</em>, <em>d</em>, <em>q</em>).</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="6">
<li id="fn6"><p>You can use the Akaike criterion to compare models of the same class, but not different models, so do not use it to compare an ARIMA model to an ETS model. You cannot use the Akaike criterion for models of different levels of differencing.<a href="arima.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exponential.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dynamic.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["time-series.pdf", "time-series.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
