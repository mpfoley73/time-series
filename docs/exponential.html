<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Exponential Smoothing | Time Series Analysis</title>
  <meta name="description" content="Time series analysis using R." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Exponential Smoothing | Time Series Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Time series analysis using R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Exponential Smoothing | Time Series Analysis" />
  
  <meta name="twitter:description" content="Time series analysis using R." />
  

<meta name="author" content="Michael Foley" />


<meta name="date" content="2023-08-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regression.html"/>
<link rel="next" href="arima.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series Analysis in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="toolbox.html"><a href="toolbox.html"><i class="fa fa-check"></i><b>1</b> Toolbox</a>
<ul>
<li class="chapter" data-level="1.1" data-path="toolbox.html"><a href="toolbox.html#r-structures"><i class="fa fa-check"></i><b>1.1</b> R Structures</a>
<ul>
<li class="chapter" data-level="" data-path="toolbox.html"><a href="toolbox.html#ts-zoo-and-xts"><i class="fa fa-check"></i>ts, zoo, and xts</a></li>
<li class="chapter" data-level="" data-path="toolbox.html"><a href="toolbox.html#tsibble"><i class="fa fa-check"></i>tsibble</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="toolbox.html"><a href="toolbox.html#fitting-models"><i class="fa fa-check"></i><b>1.2</b> Fitting Models</a></li>
<li class="chapter" data-level="1.3" data-path="toolbox.html"><a href="toolbox.html#evaluating-models"><i class="fa fa-check"></i><b>1.3</b> Evaluating Models</a></li>
<li class="chapter" data-level="1.4" data-path="toolbox.html"><a href="toolbox.html#evaluating-accuracy"><i class="fa fa-check"></i><b>1.4</b> Evaluating Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exporation.html"><a href="exporation.html"><i class="fa fa-check"></i><b>2</b> Exploratory Analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="exporation.html"><a href="exporation.html#graphical-analysis"><i class="fa fa-check"></i><b>2.1</b> Graphical Analysis</a></li>
<li class="chapter" data-level="2.2" data-path="exporation.html"><a href="exporation.html#transformations"><i class="fa fa-check"></i><b>2.2</b> Transformations</a></li>
<li class="chapter" data-level="2.3" data-path="exporation.html"><a href="exporation.html#decomposition"><i class="fa fa-check"></i><b>2.3</b> Decomposition</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="exporation.html"><a href="exporation.html#classical-decomposition"><i class="fa fa-check"></i><b>2.3.1</b> Classical Decomposition</a></li>
<li class="chapter" data-level="2.3.2" data-path="exporation.html"><a href="exporation.html#x-11-and-seats"><i class="fa fa-check"></i><b>2.3.2</b> X-11 and SEATS</a></li>
<li class="chapter" data-level="2.3.3" data-path="exporation.html"><a href="exporation.html#stl"><i class="fa fa-check"></i><b>2.3.3</b> STL</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>3</b> Time Series Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="regression.html"><a href="regression.html#exploratory-analysis"><i class="fa fa-check"></i><b>3.1</b> Exploratory Analysis</a></li>
<li class="chapter" data-level="3.2" data-path="regression.html"><a href="regression.html#fit-model"><i class="fa fa-check"></i><b>3.2</b> Fit Model</a>
<ul>
<li class="chapter" data-level="" data-path="regression.html"><a href="regression.html#special-predictors"><i class="fa fa-check"></i>Special Predictors</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="regression.html"><a href="regression.html#model-evaluation"><i class="fa fa-check"></i><b>3.3</b> Model Evaluation</a>
<ul>
<li class="chapter" data-level="" data-path="regression.html"><a href="regression.html#outliers-leverage-points-and-influential-points"><i class="fa fa-check"></i>Outliers, Leverage Points, and Influential Points</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="regression.html"><a href="regression.html#variable-selection"><i class="fa fa-check"></i><b>3.4</b> Variable Selection</a></li>
<li class="chapter" data-level="3.5" data-path="regression.html"><a href="regression.html#predicting-values"><i class="fa fa-check"></i><b>3.5</b> Predicting Values</a></li>
<li class="chapter" data-level="3.6" data-path="regression.html"><a href="regression.html#nonlinear-regression"><i class="fa fa-check"></i><b>3.6</b> Nonlinear Regression</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exponential.html"><a href="exponential.html"><i class="fa fa-check"></i><b>4</b> Exponential Smoothing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exponential.html"><a href="exponential.html#simple-exponential-smoothing-ses"><i class="fa fa-check"></i><b>4.1</b> Simple Exponential Smoothing (SES)</a></li>
<li class="chapter" data-level="4.2" data-path="exponential.html"><a href="exponential.html#holts-linear-method"><i class="fa fa-check"></i><b>4.2</b> Holt’s Linear Method</a></li>
<li class="chapter" data-level="4.3" data-path="exponential.html"><a href="exponential.html#additive-damped-trend-method"><i class="fa fa-check"></i><b>4.3</b> Additive Damped Trend Method</a></li>
<li class="chapter" data-level="4.4" data-path="exponential.html"><a href="exponential.html#holt-winters"><i class="fa fa-check"></i><b>4.4</b> Holt-Winters</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="exponential.html"><a href="exponential.html#additive-holt-winters-method"><i class="fa fa-check"></i><b>4.4.1</b> Additive Holt-Winters Method</a></li>
<li class="chapter" data-level="4.4.2" data-path="exponential.html"><a href="exponential.html#multiplicative-holt-winters-method"><i class="fa fa-check"></i><b>4.4.2</b> Multiplicative Holt-Winters Method</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="exponential.html"><a href="exponential.html#model-selection-with-cv"><i class="fa fa-check"></i><b>4.5</b> Model Selection with CV</a></li>
<li class="chapter" data-level="4.6" data-path="exponential.html"><a href="exponential.html#model-selection-via-maximum-likelihood"><i class="fa fa-check"></i><b>4.6</b> Model Selection via Maximum Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="arima.html"><a href="arima.html"><i class="fa fa-check"></i><b>5</b> ARIMA</a>
<ul>
<li class="chapter" data-level="5.1" data-path="arima.html"><a href="arima.html#tranformations-and-differencing"><i class="fa fa-check"></i><b>5.1</b> Tranformations and Differencing</a></li>
<li class="chapter" data-level="5.2" data-path="arima.html"><a href="arima.html#autoregressive-models"><i class="fa fa-check"></i><b>5.2</b> Autoregressive Models</a></li>
<li class="chapter" data-level="5.3" data-path="arima.html"><a href="arima.html#moving-average-models"><i class="fa fa-check"></i><b>5.3</b> Moving Average Models</a></li>
<li class="chapter" data-level="5.4" data-path="arima.html"><a href="arima.html#non-seasonal-arima"><i class="fa fa-check"></i><b>5.4</b> Non-Seasonal ARIMA</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dynamic.html"><a href="dynamic.html"><i class="fa fa-check"></i><b>6</b> Dynamic Harmonic Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="dynamic.html"><a href="dynamic.html#tbats-model"><i class="fa fa-check"></i><b>6.1</b> TBATS Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Time Series Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exponential" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Exponential Smoothing<a href="exponential.html#exponential" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Exponential smoothing methods are weighted averages of past observations, with the weights decaying exponentially as the observations get more remote. Exponential smoothing is a family of methods that vary by their <em>trend</em> and <em>seasonal</em> components.</p>
<table class=" lightable-classic table table-condensed" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; float: right; margin-left: 10px; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-53">Table 4.1: </span>Exponential smoothing taxonomy.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Seasonal Component
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Trend Component
</th>
<th style="text-align:left;">
None <br>(N)
</th>
<th style="text-align:left;">
Additive <br>(A)
</th>
<th style="text-align:left;">
Multiplicative <br>(M)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
None (N)
</td>
<td style="text-align:left;">
(N, N)<br>Simple <br>Exponential <br>Smoothing
</td>
<td style="text-align:left;">
(N, A)
</td>
<td style="text-align:left;">
(N, M)
</td>
</tr>
<tr>
<td style="text-align:left;">
Additive (A)
</td>
<td style="text-align:left;">
(A, N)<br>Holt’s <br>linear <br>method
</td>
<td style="text-align:left;">
(A, A)<br>Additive <br>Holt-Winters’ <br>method
</td>
<td style="text-align:left;">
(A, M)<br>Multiplicative <br>Holt-Winters’ <br>method
</td>
</tr>
<tr>
<td style="text-align:left;">
Additive Damped (A<sub>d</sub>)
</td>
<td style="text-align:left;">
(A<sub>d</sub>, N)<br>Additive <br>damped <br>trend <br>method
</td>
<td style="text-align:left;">
(A<sub>d</sub>, A)
</td>
<td style="text-align:left;">
(A<sub>d</sub>, M)<br>Holt-Winters’ <br>damped <br>method
</td>
</tr>
</tbody>
</table>
<ul>
<li><p>There can be no trend (N), an additive (A) linear trend from the forecast horizon, or a damped additive (A<sub>d</sub>) trend leveling off from the forecast horizon. <em>The trend could also be multiplicative (M) or multiplicative damped (M<sub>d</sub>), but <a href="https://otexts.com/fpp3/taxonomy.html">Hyndman</a> explains that they do not produced good forecasts.</em></p></li>
<li><p>There can be no seasonality (N), or it can be additive (A) change, or multiplicative (M) (proportional) change. <em>Apparently seasonality does not have an additive damped version.</em></p></li>
</ul>
<p>The trend and seasonal combinations produce 3 x 3 = 9 possible exponential smoothing methods. ETS (Error, Trend, and Seasonality) models double the number of possible <em>state space models</em> to 18 by treating the error variances as either additive (A) or multiplicative (M). ETS models do not just extend the exponential smoothing models; they also estimate their parameters differently, using maximum likelihood estimation. For models with additive errors, this is equivalent to minimizing the sum of squared errors (SSE). The great advantage of using ETS models is that you can optimize the parameter settings by minimizing the Akaike Information Criterion (AIC<sub>c</sub>).</p>
<p>The <code>fable::ETS()</code> function fits ETS models. The combinations are specified through the formula:</p>
<p><code>ETS(y ~ error(c("A", "M")) + trend(c("N", "A", "Ad")) + season(c("N", "A", "M"))</code></p>
<p>The following sections review just the named models above.</p>
<div id="simple-exponential-smoothing-ses" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Simple Exponential Smoothing (SES)<a href="exponential.html#simple-exponential-smoothing-ses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Simple exponential smoothing models have no seasonal or trend components. Simple exponential smoothing models are of the form <span class="math inline">\(\hat{y}_{T+h|T} = \alpha y_T + \alpha(1-\alpha)y_{T-1} + \alpha(1-\alpha)^2y_{T-2} \dots\)</span> where <span class="math inline">\(0 &lt; \alpha &lt; 1\)</span> is a weighting parameter. On the one extreme, <span class="math inline">\(\alpha\)</span> = 1 is the same as a naive model. On the other extreme <span class="math inline">\(\alpha \approx\)</span> 0 is the average model.</p>
<p>Exponential smoothing models are commonly expressed in a component form as a recursive model.</p>
<p><span class="math display">\[
\begin{align}
\hat{y}_{t+h|t} &amp;= l_t \\
l_t &amp;= \alpha y_t + (1 - \alpha)l_{t-1}
\end{align}
\]</span></p>
<p>The first component, <span class="math inline">\(\hat{y}_{t+h|t}\)</span>, is the forecast. It equals the last value of the estimated level, kind of like a y-intercept. The second component, <span class="math inline">\(l_t\)</span> is the level (or smoothed value) of the series at time <span class="math inline">\(t\)</span>. It describes how the level changes over time, kind of like a slope.</p>
<p>There are two parameters to estimate: <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(l_0\)</span> - the level at base of the recursion. Estimate the parameters by minimizing the SSE with a nonlinear optimization method (black box for me).</p>
<div id="example" class="section level4 unnumbered hasAnchor">
<h4>Example<a href="exponential.html#example" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Data set <code>tsibbledata::global_economy</code> contains annual country-level economic indicators, including <code>Exports</code>. This time series has no trend or seasonality, so it is a good candidate for a simple exponential smoothing model.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="exponential.html#cb73-1" tabindex="-1"></a>tsibbledata<span class="sc">::</span>global_economy <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="exponential.html#cb73-2" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;Algeria&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="exponential.html#cb73-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Exports)) <span class="sc">+</span></span>
<span id="cb73-4"><a href="exponential.html#cb73-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb73-5"><a href="exponential.html#cb73-5" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb73-6"><a href="exponential.html#cb73-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Algerian exports (% of GDP) show no trend or seasonality.&quot;</span>)</span></code></pre></div>
<p><img src="time-series_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p><code>ETS()</code> is <strong>fable’s</strong> exponential smoothing function. Using additive errors, this is an ETS(A, N, N) model.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="exponential.html#cb74-1" tabindex="-1"></a>mdl_ses <span class="ot">&lt;-</span> tsibbledata<span class="sc">::</span>global_economy <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="exponential.html#cb74-2" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;Algeria&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="exponential.html#cb74-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Exports <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;N&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)))</span>
<span id="cb74-4"><a href="exponential.html#cb74-4" tabindex="-1"></a></span>
<span id="cb74-5"><a href="exponential.html#cb74-5" tabindex="-1"></a>mdl_ses <span class="sc">%&gt;%</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Exports 
## Model: ETS(A,N,N) 
##   Smoothing parameters:
##     alpha = 0.8399875 
## 
##   Initial states:
##    l[0]
##  39.539
## 
##   sigma^2:  35.6301
## 
##      AIC     AICc      BIC 
## 446.7154 447.1599 452.8968</code></pre>
<p><code>ETS()</code> estimates <span class="math inline">\(\hat{l}_0\)</span> = 39.539 and <span class="math inline">\(\hat{\alpha}\)</span> = 0.840, a high weighting on the prior value.</p>
<p>Check the model assumptions with residuals plots.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="exponential.html#cb76-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(mdl_ses)</span></code></pre></div>
<p><img src="time-series_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<p>Autocorrelation in the residuals increases the prediction intervals. The autocorrelation function plot finds a barely significant negative spike at lag 12 (years). Heteroscedasticity can make prediction intervals inaccurate. The residuals vs time diagnostic plot finds no heteroscedasticity, although there might be an outlier around 1962. Non-normality of the residuals can also make the prediction intervals inaccurate. The histogram shows that the residuals are slightly left-skewed.</p>
<p>Use the fitted model to forecast the response variable for five periods.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="exponential.html#cb77-1" tabindex="-1"></a>mdl_ses_fc <span class="ot">&lt;-</span> mdl_ses <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="exponential.html#cb77-2" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="exponential.html#cb77-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sigma =</span> <span class="fu">map_dbl</span>(Exports, <span class="sc">~</span><span class="fu">unlist</span>(.) <span class="sc">%&gt;%</span> .[<span class="st">&quot;sigma&quot;</span>]),</span>
<span id="cb77-4"><a href="exponential.html#cb77-4" tabindex="-1"></a>         <span class="at">ci_025 =</span> <span class="fu">qnorm</span>(.<span class="dv">025</span>, .mean, sigma),</span>
<span id="cb77-5"><a href="exponential.html#cb77-5" tabindex="-1"></a>         <span class="at">ci_975 =</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, .mean, sigma))</span>
<span id="cb77-6"><a href="exponential.html#cb77-6" tabindex="-1"></a></span>
<span id="cb77-7"><a href="exponential.html#cb77-7" tabindex="-1"></a>mdl_ses <span class="sc">%&gt;%</span></span>
<span id="cb77-8"><a href="exponential.html#cb77-8" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb77-9"><a href="exponential.html#cb77-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year)) <span class="sc">+</span></span>
<span id="cb77-10"><a href="exponential.html#cb77-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Exports)) <span class="sc">+</span></span>
<span id="cb77-11"><a href="exponential.html#cb77-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb77-12"><a href="exponential.html#cb77-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> mdl_ses_fc, <span class="fu">aes</span>(<span class="at">y =</span> .mean), <span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb77-13"><a href="exponential.html#cb77-13" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> mdl_ses_fc, </span>
<span id="cb77-14"><a href="exponential.html#cb77-14" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> ci_025, <span class="at">ymax =</span> ci_975),</span>
<span id="cb77-15"><a href="exponential.html#cb77-15" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb77-16"><a href="exponential.html#cb77-16" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb77-17"><a href="exponential.html#cb77-17" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Simple Exponential Smoothing ETS(A, N, N)&quot;</span>,</span>
<span id="cb77-18"><a href="exponential.html#cb77-18" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Algerian exports (% of GDP).&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: The output of `fortify(&lt;fable&gt;)` has changed to better suit usage with the ggdist package.
## If you&#39;re using it to extract intervals, consider using `hilo()` to compute intervals, and `unpack_hilo()` to obtain values.
## The output of `fortify(&lt;fable&gt;)` has changed to better suit usage with the ggdist package.
## If you&#39;re using it to extract intervals, consider using `hilo()` to compute intervals, and `unpack_hilo()` to obtain values.</code></pre>
<p><img src="time-series_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
</div>
<div id="holts-linear-method" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Holt’s Linear Method<a href="exponential.html#holts-linear-method" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Holt’s linear method extends SES with a trend component.</p>
<p><span class="math display">\[
\begin{align}
\hat{y}_{t+h|t} &amp;= l_t + hb_t \\
l_t &amp;= \alpha y_t + (1 - \alpha)(l_{t-1} + hb_{t-1}) \\
b_t &amp;= \beta^*(l_t - l_{t-1}) + (1 - \beta^*)b_{t-1}
\end{align}
\]</span></p>
<p>The level equation, <span class="math inline">\(l_t\)</span> is the same except for a trend adjustment. A third equation, <span class="math inline">\(b_t\)</span>, the trend, describes how the slope changes over time. The parameter <span class="math inline">\(\beta^*\)</span> describes how quickly the slope can change. Now there are four parameter to estimate, <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(l_0\)</span>, <span class="math inline">\(\beta^*\)</span>, and <span class="math inline">\(b_0\)</span>.</p>
<div id="example-1" class="section level4 unnumbered hasAnchor">
<h4>Example<a href="exponential.html#example-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Data set <code>tsibbledata::global_economy</code> contains annual country-level economic indicators, including <code>Population</code> size. This time series has a trend, so it is a good candidate for Holt’s linear trend method.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="exponential.html#cb79-1" tabindex="-1"></a>tsibbledata<span class="sc">::</span>global_economy <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="exponential.html#cb79-2" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;Australia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="exponential.html#cb79-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Population)) <span class="sc">+</span></span>
<span id="cb79-4"><a href="exponential.html#cb79-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb79-5"><a href="exponential.html#cb79-5" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb79-6"><a href="exponential.html#cb79-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Australian population has trend, but no seasonality.&quot;</span>)</span></code></pre></div>
<p><img src="time-series_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>Fit the model with <code>ETS()</code> again. This time specify an “additive” trend, ETS(A, A, N).</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="exponential.html#cb80-1" tabindex="-1"></a>mdl_holt <span class="ot">&lt;-</span> tsibbledata<span class="sc">::</span>global_economy <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="exponential.html#cb80-2" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;Australia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="exponential.html#cb80-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Population <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)))</span>
<span id="cb80-4"><a href="exponential.html#cb80-4" tabindex="-1"></a></span>
<span id="cb80-5"><a href="exponential.html#cb80-5" tabindex="-1"></a>mdl_holt <span class="sc">%&gt;%</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Population 
## Model: ETS(A,A,N) 
##   Smoothing parameters:
##     alpha = 0.9998992 
##     beta  = 0.3257153 
## 
##   Initial states:
##      l[0]     b[0]
##  10067191 228012.5
## 
##   sigma^2:  4139605871
## 
##      AIC     AICc      BIC 
## 1525.705 1526.859 1536.008</code></pre>
<p><code>ETS()</code> estimates an <span class="math inline">\(\hat{l}_0\)</span> of 10,067,191 people at period 0 (1960) with a very high weighting on recent values <span class="math inline">\(\hat{\alpha}\)</span> of 0.9999. <span class="math inline">\(\alpha\)</span> is high when the trend increases rapidly. <span class="math inline">\(\beta_0\)</span> is 228,013 with a <span class="math inline">\(\hat{\beta}\)</span> of 0.326. This is a fairly large <span class="math inline">\(\beta\)</span>, meaning the trend changes often.</p>
<p>Check the model assumptions with residuals plots. I’ll skip that step this time and move on to forecasting.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="exponential.html#cb82-1" tabindex="-1"></a>mdl_holt_fc <span class="ot">&lt;-</span> mdl_holt <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="exponential.html#cb82-2" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="exponential.html#cb82-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sigma =</span> <span class="fu">map_dbl</span>(Population, <span class="sc">~</span><span class="fu">unlist</span>(.) <span class="sc">%&gt;%</span> .[<span class="st">&quot;mu&quot;</span>]),</span>
<span id="cb82-4"><a href="exponential.html#cb82-4" tabindex="-1"></a>         <span class="at">ci_025 =</span> <span class="fu">qnorm</span>(.<span class="dv">025</span>, .mean, sigma),</span>
<span id="cb82-5"><a href="exponential.html#cb82-5" tabindex="-1"></a>         <span class="at">ci_975 =</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, .mean, sigma))</span>
<span id="cb82-6"><a href="exponential.html#cb82-6" tabindex="-1"></a></span>
<span id="cb82-7"><a href="exponential.html#cb82-7" tabindex="-1"></a>mdl_holt <span class="sc">%&gt;%</span></span>
<span id="cb82-8"><a href="exponential.html#cb82-8" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb82-9"><a href="exponential.html#cb82-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year)) <span class="sc">+</span></span>
<span id="cb82-10"><a href="exponential.html#cb82-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Population)) <span class="sc">+</span></span>
<span id="cb82-11"><a href="exponential.html#cb82-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-12"><a href="exponential.html#cb82-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> mdl_holt_fc, <span class="fu">aes</span>(<span class="at">y =</span> .mean), <span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-13"><a href="exponential.html#cb82-13" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> mdl_holt_fc, </span>
<span id="cb82-14"><a href="exponential.html#cb82-14" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> ci_025, <span class="at">ymax =</span> ci_975),</span>
<span id="cb82-15"><a href="exponential.html#cb82-15" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-16"><a href="exponential.html#cb82-16" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb82-17"><a href="exponential.html#cb82-17" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Holt&#39;s Linear Method&quot;</span>,</span>
<span id="cb82-18"><a href="exponential.html#cb82-18" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Australian Population.&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: The output of `fortify(&lt;fable&gt;)` has changed to better suit usage with the ggdist package.
## If you&#39;re using it to extract intervals, consider using `hilo()` to compute intervals, and `unpack_hilo()` to obtain values.
## The output of `fortify(&lt;fable&gt;)` has changed to better suit usage with the ggdist package.
## If you&#39;re using it to extract intervals, consider using `hilo()` to compute intervals, and `unpack_hilo()` to obtain values.</code></pre>
<p><img src="time-series_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
</div>
</div>
<div id="additive-damped-trend-method" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Additive Damped Trend Method<a href="exponential.html#additive-damped-trend-method" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Holt’s linear trend produces a sloped, but straight line. Research has shown that the assumption of a constant trend in the forecast tends to overshoot. Gardner and McKenzie added a damping parameter <span class="math inline">\(\phi\)</span> to reduce the forecasted trend to a flat line over time. The forecast equation replaces the <span class="math inline">\(h\)</span> with the series <span class="math inline">\(\phi^1 + \phi^2 + \cdots + \phi^h\)</span> and the level equation replaces <span class="math inline">\(h\)</span> with <span class="math inline">\(\phi\)</span>. The trend equation adds <span class="math inline">\(\phi\)</span> as a multiplier to the second term.</p>
<p><span class="math display">\[
\begin{align}
\hat{y}_{t+h|t} &amp;= l_t + (\phi^1 + \phi^2 + \cdots + \phi^h)b_t \\
l_t &amp;= \alpha y_t + (1 - \alpha)(l_{t-1} + \phi b_{t-1}) \\
b_t &amp;= \beta^*(l_t - l_{t-1}) + (1 - \beta^*) \phi b_{t-1}
\end{align}
\]</span></p>
<p>There are now five parameters to estimate, <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta^*\)</span>, <span class="math inline">\(l_0\)</span>, <span class="math inline">\(b_0\)</span>, and <span class="math inline">\(\phi\)</span> (although you can supply a <span class="math inline">\(\phi\)</span> value to the <code>trend()</code> equation. Expect a <span class="math inline">\(\phi\)</span> between .8 and .998. This is an ETS(A, A<sub>d</sub>, N) model.</p>
<div id="example-2" class="section level4 unnumbered hasAnchor">
<h4>Example<a href="exponential.html#example-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Return to the Australian population data. You can fit the original model and the additive damped trend model in a single statement.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="exponential.html#cb84-1" tabindex="-1"></a>mdl_holt_d <span class="ot">&lt;-</span> tsibbledata<span class="sc">::</span>global_economy <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="exponential.html#cb84-2" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;Australia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="exponential.html#cb84-3" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb84-4"><a href="exponential.html#cb84-4" tabindex="-1"></a>    <span class="st">`</span><span class="at">Holt&#39;s method</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(Population <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)),</span>
<span id="cb84-5"><a href="exponential.html#cb84-5" tabindex="-1"></a>    <span class="st">`</span><span class="at">Damped Holt&#39;s method</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(Population <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;Ad&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>))</span>
<span id="cb84-6"><a href="exponential.html#cb84-6" tabindex="-1"></a>  )</span>
<span id="cb84-7"><a href="exponential.html#cb84-7" tabindex="-1"></a></span>
<span id="cb84-8"><a href="exponential.html#cb84-8" tabindex="-1"></a>mdl_holt_d <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">Damped Holt&#39;s method</span><span class="st">`</span>) <span class="sc">%&gt;%</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Population 
## Model: ETS(A,Ad,N) 
##   Smoothing parameters:
##     alpha = 0.9998988 
##     beta  = 0.4392868 
##     phi   = 0.98 
## 
##   Initial states:
##      l[0]     b[0]
##  10067191 277729.2
## 
##   sigma^2:  4584582964
## 
##      AIC     AICc      BIC 
## 1532.543 1534.190 1544.906</code></pre>
<p><code>ETS()</code> estimates <span class="math inline">\(\hat{\phi}\)</span> = 0.980 - just a small amount of damping.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="exponential.html#cb86-1" tabindex="-1"></a>mdl_holt_d_fc <span class="ot">&lt;-</span> mdl_holt_d <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="exponential.html#cb86-2" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="exponential.html#cb86-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sigma =</span> <span class="fu">map_dbl</span>(Population, <span class="sc">~</span><span class="fu">unlist</span>(.) <span class="sc">%&gt;%</span> .[<span class="st">&quot;mu&quot;</span>]),</span>
<span id="cb86-4"><a href="exponential.html#cb86-4" tabindex="-1"></a>         <span class="at">ci_025 =</span> <span class="fu">qnorm</span>(.<span class="dv">025</span>, .mean, sigma),</span>
<span id="cb86-5"><a href="exponential.html#cb86-5" tabindex="-1"></a>         <span class="at">ci_975 =</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, .mean, sigma))</span>
<span id="cb86-6"><a href="exponential.html#cb86-6" tabindex="-1"></a></span>
<span id="cb86-7"><a href="exponential.html#cb86-7" tabindex="-1"></a>mdl_holt <span class="sc">%&gt;%</span></span>
<span id="cb86-8"><a href="exponential.html#cb86-8" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb86-9"><a href="exponential.html#cb86-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year)) <span class="sc">+</span></span>
<span id="cb86-10"><a href="exponential.html#cb86-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Population)) <span class="sc">+</span></span>
<span id="cb86-11"><a href="exponential.html#cb86-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb86-12"><a href="exponential.html#cb86-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> mdl_holt_d_fc, <span class="fu">aes</span>(<span class="at">y =</span> .mean, <span class="at">color =</span> .model)) <span class="sc">+</span></span>
<span id="cb86-13"><a href="exponential.html#cb86-13" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> mdl_holt_d_fc, </span>
<span id="cb86-14"><a href="exponential.html#cb86-14" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> ci_025, <span class="at">ymax =</span> ci_975, <span class="at">fill =</span> .model),</span>
<span id="cb86-15"><a href="exponential.html#cb86-15" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb86-16"><a href="exponential.html#cb86-16" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Holt&#39;s method</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;goldenrod&quot;</span>, </span>
<span id="cb86-17"><a href="exponential.html#cb86-17" tabindex="-1"></a>                               <span class="st">`</span><span class="at">Damped Holt&#39;s method</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;seagreen&quot;</span>)) <span class="sc">+</span></span>
<span id="cb86-18"><a href="exponential.html#cb86-18" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Holt&#39;s method</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;goldenrod&quot;</span>, </span>
<span id="cb86-19"><a href="exponential.html#cb86-19" tabindex="-1"></a>                               <span class="st">`</span><span class="at">Damped Holt&#39;s method</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;seagreen&quot;</span>)) <span class="sc">+</span></span>
<span id="cb86-20"><a href="exponential.html#cb86-20" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb86-21"><a href="exponential.html#cb86-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Model&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Model&quot;</span>,</span>
<span id="cb86-22"><a href="exponential.html#cb86-22" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Additive Damped Trend Method&quot;</span>,</span>
<span id="cb86-23"><a href="exponential.html#cb86-23" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Australian Population&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: The output of `fortify(&lt;fable&gt;)` has changed to better suit usage with the ggdist package.
## If you&#39;re using it to extract intervals, consider using `hilo()` to compute intervals, and `unpack_hilo()` to obtain values.
## The output of `fortify(&lt;fable&gt;)` has changed to better suit usage with the ggdist package.
## If you&#39;re using it to extract intervals, consider using `hilo()` to compute intervals, and `unpack_hilo()` to obtain values.</code></pre>
<p><img src="time-series_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</div>
</div>
<div id="holt-winters" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Holt-Winters<a href="exponential.html#holt-winters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Holt-Winters method extends Holt’s method with a seasonality component, <span class="math inline">\(s_t\)</span>, for <span class="math inline">\(m\)</span> seasons per period. There are two versions of this model, the <em>additive</em> and the <em>multiplicative</em>. The additive method assumes the error variance is constant, and the seasonal component sums to approximately zero over the course of the year. The multiplicative version assumes the error variance scales with the level, and the seasonal component sums to approximately <span class="math inline">\(m\)</span> over the course of the year.</p>
<div id="additive-holt-winters-method" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Additive Holt-Winters Method<a href="exponential.html#additive-holt-winters-method" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The additive method introduces the seasonality component as an additive element.</p>
<p><span class="math display">\[
\begin{align}
\hat{y}_{t+h|t} &amp;= l_t + hb_t + s_{t+h-m(k+1)} \\
l_t &amp;= \alpha(y_t - s_{t-m}) + (1 - \alpha)(l_{t-1} + b_{t-1}) \\
b_t &amp;= \beta^*(l_t - l_{t-1}) + (1 - \beta^*)b_{t-1} \\
s_t &amp;= \gamma(y_t - l_{t-1} - b_{t-1}) + (1 - \gamma)s_{t-m}
\end{align}
\]</span></p>
<p><span class="math inline">\(k\)</span> is the modulus of <span class="math inline">\((h - 1) / m\)</span>, so <span class="math inline">\(s_{t+h-m(k+1)}\)</span> is always based on the prior seasonal period. <span class="math inline">\(l_t\)</span> is a weighted average (<span class="math inline">\(alpha\)</span> weighting) between the seasonally adjusted observation and the non-seasonal forecast. The trend component is unchanged. The seasonal component is a weighted average (<span class="math inline">\(\gamma\)</span> weighting) between the current seasonal index and the same season of the prior season period.</p>
<p>Now there are five smoothing parameters to estimate: <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(l_0\)</span>, <span class="math inline">\(\beta^*\)</span>, <span class="math inline">\(b_0\)</span>, and <span class="math inline">\(\gamma\)</span>, plus an initial value for each season of the seasonal period.</p>
</div>
<div id="multiplicative-holt-winters-method" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Multiplicative Holt-Winters Method<a href="exponential.html#multiplicative-holt-winters-method" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the multiplicative version, the seasonality averages to one. Use the multiplicative method if the seasonal variation increases with the level.</p>
<p><span class="math display">\[
\begin{align}
\hat{y}_{t+h|t} &amp;= (l_t + hb_t) s_{t+h-m(k+1)} \\
l_t &amp;= \alpha\frac{y_t}{s_{t-m}} + (1 - \alpha)(l_{t-1} + b_{t-1}) \\
b_t &amp;= \beta^*(l_t - l_{t-1}) + (1-\beta*)b_{t-1} \\
s_t &amp;= \gamma\frac{y_t}{(l_{t-1} - b_{t-1})} + (1 - \gamma)s_{t-m} \\
\end{align}
\]</span></p>
<div id="example-3" class="section level4 unnumbered hasAnchor">
<h4>Example<a href="exponential.html#example-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Data set <code>tsibble::tourism</code> contains quarterly domestic tourist visit-nights in Australia. The plot below is extended with forecasts using the Holt-Winters additive method and the Holt-Winters seasonal method. It’s not obvious whether the error variance increases with the series level, so either the additive or the multiplicative method may be appropriate. The RMSE from the multiplicative model</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="exponential.html#cb88-1" tabindex="-1"></a>tour <span class="ot">&lt;-</span> tsibble<span class="sc">::</span>tourism <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="exponential.html#cb88-2" tabindex="-1"></a>  <span class="fu">filter</span>(Purpose <span class="sc">==</span> <span class="st">&quot;Holiday&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-3"><a href="exponential.html#cb88-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Trips =</span> <span class="fu">sum</span>(Trips) <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb88-4"><a href="exponential.html#cb88-4" tabindex="-1"></a></span>
<span id="cb88-5"><a href="exponential.html#cb88-5" tabindex="-1"></a>tour_fit <span class="ot">&lt;-</span> tour <span class="sc">%&gt;%</span></span>
<span id="cb88-6"><a href="exponential.html#cb88-6" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb88-7"><a href="exponential.html#cb88-7" tabindex="-1"></a>    <span class="at">Additive =</span> <span class="fu">ETS</span>(Trips <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;A&quot;</span>)),</span>
<span id="cb88-8"><a href="exponential.html#cb88-8" tabindex="-1"></a>    <span class="at">Multiplicative =</span> <span class="fu">ETS</span>(Trips <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;M&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;M&quot;</span>))</span>
<span id="cb88-9"><a href="exponential.html#cb88-9" tabindex="-1"></a>  )</span>
<span id="cb88-10"><a href="exponential.html#cb88-10" tabindex="-1"></a></span>
<span id="cb88-11"><a href="exponential.html#cb88-11" tabindex="-1"></a>tour_fit <span class="sc">%&gt;%</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Warning in report.mdl_df(.): Model reporting is only supported for individual
## models, so a glance will be shown. To see the report for a specific model, use
## `select()` and `filter()` to identify a single model.</code></pre>
<pre><code>## # A tibble: 2 × 9
##   .model          sigma2 log_lik   AIC  AICc   BIC   MSE  AMSE    MAE
##   &lt;chr&gt;            &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1 Additive       0.193     -105.  229.  231.  250. 0.174 0.184 0.321 
## 2 Multiplicative 0.00212   -104.  227.  229.  248. 0.170 0.183 0.0328</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="exponential.html#cb91-1" tabindex="-1"></a>tour_fit_fc <span class="ot">&lt;-</span> tour_fit <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="exponential.html#cb91-2" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="exponential.html#cb91-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sigma =</span> <span class="fu">map_dbl</span>(Trips, <span class="sc">~</span><span class="fu">unlist</span>(.) <span class="sc">%&gt;%</span> .[<span class="st">&quot;mu&quot;</span>]),</span>
<span id="cb91-4"><a href="exponential.html#cb91-4" tabindex="-1"></a>         <span class="at">ci_025 =</span> <span class="fu">qnorm</span>(.<span class="dv">025</span>, .mean, sigma),</span>
<span id="cb91-5"><a href="exponential.html#cb91-5" tabindex="-1"></a>         <span class="at">ci_975 =</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, .mean, sigma))</span>
<span id="cb91-6"><a href="exponential.html#cb91-6" tabindex="-1"></a></span>
<span id="cb91-7"><a href="exponential.html#cb91-7" tabindex="-1"></a>tour_fit_aug <span class="ot">&lt;-</span> tour_fit <span class="sc">%&gt;%</span></span>
<span id="cb91-8"><a href="exponential.html#cb91-8" tabindex="-1"></a>  <span class="fu">augment</span>()</span>
<span id="cb91-9"><a href="exponential.html#cb91-9" tabindex="-1"></a></span>
<span id="cb91-10"><a href="exponential.html#cb91-10" tabindex="-1"></a>tour_fit_aug <span class="sc">%&gt;%</span> </span>
<span id="cb91-11"><a href="exponential.html#cb91-11" tabindex="-1"></a>  <span class="co"># filter(.model == &quot;Additive&quot;) %&gt;%</span></span>
<span id="cb91-12"><a href="exponential.html#cb91-12" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Quarter)) <span class="sc">+</span></span>
<span id="cb91-13"><a href="exponential.html#cb91-13" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Trips)) <span class="sc">+</span></span>
<span id="cb91-14"><a href="exponential.html#cb91-14" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">color =</span> .model)) <span class="sc">+</span></span>
<span id="cb91-15"><a href="exponential.html#cb91-15" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> tour_fit_fc, <span class="fu">aes</span>(<span class="at">y =</span> .mean, <span class="at">color =</span> .model)) <span class="sc">+</span></span>
<span id="cb91-16"><a href="exponential.html#cb91-16" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> tour_fit_fc, </span>
<span id="cb91-17"><a href="exponential.html#cb91-17" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> ci_025, <span class="at">ymax =</span> ci_975, <span class="at">fill =</span> .model),</span>
<span id="cb91-18"><a href="exponential.html#cb91-18" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb91-19"><a href="exponential.html#cb91-19" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Additive&quot;</span> <span class="ot">=</span> <span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;Multiplicative&quot;</span> <span class="ot">=</span> <span class="st">&quot;slategray&quot;</span>)) <span class="sc">+</span></span>
<span id="cb91-20"><a href="exponential.html#cb91-20" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Additive&quot;</span> <span class="ot">=</span> <span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;Multiplicative&quot;</span> <span class="ot">=</span> <span class="st">&quot;slategray&quot;</span>)) <span class="sc">+</span></span>
<span id="cb91-21"><a href="exponential.html#cb91-21" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb91-22"><a href="exponential.html#cb91-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Australian Domestic Tourism with Holt-Winters Models.&quot;</span>,</span>
<span id="cb91-23"><a href="exponential.html#cb91-23" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Trips (millions)&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Model&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Model&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: The output of `fortify(&lt;fable&gt;)` has changed to better suit usage with the ggdist package.
## If you&#39;re using it to extract intervals, consider using `hilo()` to compute intervals, and `unpack_hilo()` to obtain values.
## The output of `fortify(&lt;fable&gt;)` has changed to better suit usage with the ggdist package.
## If you&#39;re using it to extract intervals, consider using `hilo()` to compute intervals, and `unpack_hilo()` to obtain values.</code></pre>
<p><img src="time-series_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<p>Notice below that the additive seasonal component estimates (<code>s[0]</code> to <code>s[-3]</code>) sum to approximately zero.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="exponential.html#cb93-1" tabindex="-1"></a>tour_fit <span class="sc">%&gt;%</span> <span class="fu">select</span>(Additive) <span class="sc">%&gt;%</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Trips 
## Model: ETS(A,A,A) 
##   Smoothing parameters:
##     alpha = 0.2620382 
##     beta  = 0.04314266 
##     gamma = 0.0001000312 
## 
##   Initial states:
##      l[0]       b[0]      s[0]      s[-1]      s[-2]    s[-3]
##  9.791341 0.02106875 -0.534408 -0.6697662 -0.2937802 1.497954
## 
##   sigma^2:  0.1931
## 
##      AIC     AICc      BIC 
## 228.5676 231.1390 250.0058</code></pre>
<p>And the multiplicative seasonal component estimates (<code>s[0]</code> to <code>s[-3]</code>) sum to approximately 4 - the number of seasons in the seasonal period.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="exponential.html#cb95-1" tabindex="-1"></a>tour_fit <span class="sc">%&gt;%</span> <span class="fu">select</span>(Multiplicative) <span class="sc">%&gt;%</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Trips 
## Model: ETS(M,A,M) 
##   Smoothing parameters:
##     alpha = 0.2236926 
##     beta  = 0.03042124 
##     gamma = 0.0001000009 
## 
##   Initial states:
##      l[0]        b[0]      s[0]     s[-1]     s[-2]    s[-3]
##  10.01351 -0.01141645 0.9430572 0.9270043 0.9692079 1.160731
## 
##   sigma^2:  0.0021
## 
##      AIC     AICc      BIC 
## 226.7196 229.2910 248.1578</code></pre>
<p>Check the model assumptions with <code>checkresiduals</code>. The residuals plot shows some long-term autocorrelation (a long hump), and the variance increases in the latter years. The histogram shows a normal distribution. The autocorrelation function (ACF) plot shows many spikes outside the insignificance band, and the Ljung-Box test rejects the null hypothesis of no autocorrelation of the residuals (p &lt; 0.0001).</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="exponential.html#cb97-1" tabindex="-1"></a><span class="co"># checkresiduals(a10.hw)</span></span></code></pre></div>
<p>Here is a four-week Holt-Winters forecast of the <code>hyndsight</code> dataset of daily pageviews on the Hyndsight blog for one year starting April 30, 2014. Create a training dataset consisting of all obserations minus the last four weeks. Then forecast those four weeks with Holt-Winters. Use the <code>additive</code> method because the variance is not scaling with page volume. Creae a second forecast with the seasonal naive method as a benchmark.</p>
<p>Notice that the Ljung-Box test rejects the null hypothesis of no autocorrelation of the residuals. The forecast might still provide useful information even with residuals that fail the white noise test.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="exponential.html#cb98-1" tabindex="-1"></a><span class="co"># hyndsight.train &lt;- subset(hyndsight, end = length(hyndsight) - 4*7)</span></span>
<span id="cb98-2"><a href="exponential.html#cb98-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb98-3"><a href="exponential.html#cb98-3" tabindex="-1"></a><span class="co"># hyndsight.hw &lt;- hw(hyndsight.train, seasonal = &quot;additive&quot;, h = 4*7)</span></span>
<span id="cb98-4"><a href="exponential.html#cb98-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb98-5"><a href="exponential.html#cb98-5" tabindex="-1"></a><span class="co"># hyndsight.sn &lt;- snaive(hyndsight.train, h = 4*7)</span></span>
<span id="cb98-6"><a href="exponential.html#cb98-6" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb98-7"><a href="exponential.html#cb98-7" tabindex="-1"></a><span class="co"># checkresiduals(hyndsight.hw)</span></span></code></pre></div>
<p>Compare Holt-Winters to the seasonal naive forecast. The RMSE of Holt-Winters (201.7656) is smaller than the RMSE of seasonal naive (202.7610), so it is the more accurate forecast.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="exponential.html#cb99-1" tabindex="-1"></a><span class="co"># accuracy(hyndsight.hw, hyndsight)</span></span>
<span id="cb99-2"><a href="exponential.html#cb99-2" tabindex="-1"></a><span class="co"># accuracy(hyndsight.sn, hyndsight)</span></span></code></pre></div>
<p>Here finally is a plot of the forecasted page views.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="exponential.html#cb100-1" tabindex="-1"></a><span class="co"># autoplot(hyndsight) +</span></span>
<span id="cb100-2"><a href="exponential.html#cb100-2" tabindex="-1"></a><span class="co">#   autolayer(hyndsight.hw$mean)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="model-selection-with-cv" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Model Selection with CV<a href="exponential.html#model-selection-with-cv" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s compare the performance of a few candidate models for the base R datasets::WWWusage data set of internet usage.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="exponential.html#cb101-1" tabindex="-1"></a>datasets<span class="sc">::</span>WWWusage <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="exponential.html#cb101-2" tabindex="-1"></a>  <span class="fu">as_tsibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="exponential.html#cb101-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> index, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb101-4"><a href="exponential.html#cb101-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb101-5"><a href="exponential.html#cb101-5" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb101-6"><a href="exponential.html#cb101-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Internet usage by minute&quot;</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">&quot;Users&quot;</span>)</span></code></pre></div>
<p><img src="time-series_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<p>We will use time-series cross-validation. The data set has 100 rows. Function <code>stretch_tsibble(.init, .step)</code> takes a tsibble and creates a new tsibble for cross validation. First <code>stretch_tsibble()</code> takes the first <code>.init</code> rows from the tsibble and adds a new column <code>.id</code> with value 1. Then it takes the first <code>.init</code> + <code>.step</code> rows from the tsibble and assigns <code>.id</code> value 2. It continues like this, creating longer and longer tsibbles until it cannot create a longer one from the original tsibble. Finally, it appends these together into one long tsibble with <code>.id</code> added to the index. Nofmal cross-validation repeatedly fits a model to data set with one of the rows left out. Since <code>model()</code> fits a separate model per index value, creating this long tsibble effectively accomplishes the same thing. Note the fundamental difference here though: time seris CV does not leave out single values from points along in the time series. It leaves out <em>all</em> points after a particular point along the time series - each sub-data set starts at the beginning and is uninterrupted until reaching the varying end points. Let’s take a look at the CV data set before using it to fit the models.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="exponential.html#cb102-1" tabindex="-1"></a>www_cv <span class="ot">&lt;-</span> datasets<span class="sc">::</span>WWWusage <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="exponential.html#cb102-2" tabindex="-1"></a>  <span class="fu">as_tsibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb102-3"><a href="exponential.html#cb102-3" tabindex="-1"></a>  <span class="fu">stretch_tsibble</span>(<span class="at">.init =</span> <span class="dv">10</span>, <span class="at">.step =</span> <span class="dv">1</span>)</span>
<span id="cb102-4"><a href="exponential.html#cb102-4" tabindex="-1"></a></span>
<span id="cb102-5"><a href="exponential.html#cb102-5" tabindex="-1"></a><span class="co"># 10 rows + 11 rows + ... + 100 rows = 5,005 rows:</span></span>
<span id="cb102-6"><a href="exponential.html#cb102-6" tabindex="-1"></a><span class="fu">nrow</span>(www_cv)</span>
<span id="cb102-7"><a href="exponential.html#cb102-7" tabindex="-1"></a><span class="do">## [1] 5005</span></span>
<span id="cb102-8"><a href="exponential.html#cb102-8" tabindex="-1"></a></span>
<span id="cb102-9"><a href="exponential.html#cb102-9" tabindex="-1"></a><span class="co"># .id added to index</span></span>
<span id="cb102-10"><a href="exponential.html#cb102-10" tabindex="-1"></a><span class="fu">head</span>(www_cv)</span>
<span id="cb102-11"><a href="exponential.html#cb102-11" tabindex="-1"></a><span class="do">## # A tsibble: 6 x 3 [1]</span></span>
<span id="cb102-12"><a href="exponential.html#cb102-12" tabindex="-1"></a><span class="do">## # Key:       .id [1]</span></span>
<span id="cb102-13"><a href="exponential.html#cb102-13" tabindex="-1"></a><span class="do">##   index value   .id</span></span>
<span id="cb102-14"><a href="exponential.html#cb102-14" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb102-15"><a href="exponential.html#cb102-15" tabindex="-1"></a><span class="do">## 1     1    88     1</span></span>
<span id="cb102-16"><a href="exponential.html#cb102-16" tabindex="-1"></a><span class="do">## 2     2    84     1</span></span>
<span id="cb102-17"><a href="exponential.html#cb102-17" tabindex="-1"></a><span class="do">## 3     3    85     1</span></span>
<span id="cb102-18"><a href="exponential.html#cb102-18" tabindex="-1"></a><span class="do">## 4     4    85     1</span></span>
<span id="cb102-19"><a href="exponential.html#cb102-19" tabindex="-1"></a><span class="do">## 5     5    84     1</span></span>
<span id="cb102-20"><a href="exponential.html#cb102-20" tabindex="-1"></a><span class="do">## 6     6    85     1</span></span>
<span id="cb102-21"><a href="exponential.html#cb102-21" tabindex="-1"></a></span>
<span id="cb102-22"><a href="exponential.html#cb102-22" tabindex="-1"></a><span class="co"># 91 index values</span></span>
<span id="cb102-23"><a href="exponential.html#cb102-23" tabindex="-1"></a><span class="fu">summary</span>(www_cv<span class="sc">$</span>.id)</span>
<span id="cb102-24"><a href="exponential.html#cb102-24" tabindex="-1"></a><span class="do">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb102-25"><a href="exponential.html#cb102-25" tabindex="-1"></a><span class="do">##    1.00   42.00   62.00   58.55   78.00   91.00</span></span></code></pre></div>
<p>Fit four models to the 91 data sets to compare the accuracy. Here’s the full code.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="exponential.html#cb103-1" tabindex="-1"></a>datasets<span class="sc">::</span>WWWusage <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="exponential.html#cb103-2" tabindex="-1"></a>  <span class="fu">as_tsibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-3"><a href="exponential.html#cb103-3" tabindex="-1"></a>  <span class="fu">stretch_tsibble</span>(<span class="at">.init =</span> <span class="dv">10</span>, <span class="at">.step =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-4"><a href="exponential.html#cb103-4" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb103-5"><a href="exponential.html#cb103-5" tabindex="-1"></a>    <span class="at">OLS =</span> <span class="fu">TSLM</span>(value <span class="sc">~</span> index),</span>
<span id="cb103-6"><a href="exponential.html#cb103-6" tabindex="-1"></a>    <span class="st">`</span><span class="at">Simple Exponential Smoothing</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(value <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;N&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)),</span>
<span id="cb103-7"><a href="exponential.html#cb103-7" tabindex="-1"></a>    <span class="st">`</span><span class="at">Holt&#39;s method</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(value <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)),</span>
<span id="cb103-8"><a href="exponential.html#cb103-8" tabindex="-1"></a>    <span class="st">`</span><span class="at">Holt&#39;s method (damped)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ETS</span>(value <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;Ad&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>))</span>
<span id="cb103-9"><a href="exponential.html#cb103-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb103-10"><a href="exponential.html#cb103-10" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-11"><a href="exponential.html#cb103-11" tabindex="-1"></a>  <span class="fu">accuracy</span>(<span class="at">data =</span> <span class="fu">as_tsibble</span>(datasets<span class="sc">::</span>WWWusage))</span></code></pre></div>
<pre><code>## Warning: The future dataset is incomplete, incomplete out-of-sample data will be treated as missing. 
## 1 observation is missing at 101</code></pre>
<pre><code>## # A tibble: 4 × 10
##   .model               .type      ME  RMSE   MAE     MPE  MAPE  MASE RMSSE  ACF1
##   &lt;chr&gt;                &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Holt&#39;s method        Test   0.0610  3.87  3.17   0.244  2.38 0.701 0.668 0.296
## 2 Holt&#39;s method (damp… Test   0.288   3.69  3.00   0.347  2.26 0.663 0.636 0.336
## 3 OLS                  Test  -6.01   38.7  31.4  -10.8   24.8  6.94  6.67  0.974
## 4 Simple Exponential … Test   1.46    6.05  4.81   0.904  3.55 1.06  1.04  0.803</code></pre>
<p>The best model as measured by RMSE was Holt’s method with damping. OLS was pretty bad. Let’s fit it to the whole data set and forecast future periods.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="exponential.html#cb106-1" tabindex="-1"></a>www_fit <span class="ot">&lt;-</span> datasets<span class="sc">::</span>WWWusage <span class="sc">%&gt;%</span></span>
<span id="cb106-2"><a href="exponential.html#cb106-2" tabindex="-1"></a>  <span class="fu">as_tsibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb106-3"><a href="exponential.html#cb106-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">holt_d =</span> <span class="fu">ETS</span>(value <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;Ad&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)))</span>
<span id="cb106-4"><a href="exponential.html#cb106-4" tabindex="-1"></a></span>
<span id="cb106-5"><a href="exponential.html#cb106-5" tabindex="-1"></a>www_fit <span class="sc">%&gt;%</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: value 
## Model: ETS(A,Ad,N) 
##   Smoothing parameters:
##     alpha = 0.9999 
##     beta  = 0.9966439 
##     phi   = 0.814958 
## 
##   Initial states:
##      l[0]        b[0]
##  90.35177 -0.01728234
## 
##   sigma^2:  12.2244
## 
##      AIC     AICc      BIC 
## 717.7310 718.6342 733.3620</code></pre>
<p>This time the damping parameter is very small (0.815), resulting in a quick return to the horizontal.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="exponential.html#cb108-1" tabindex="-1"></a>www_fc <span class="ot">&lt;-</span> www_fit <span class="sc">%&gt;%</span></span>
<span id="cb108-2"><a href="exponential.html#cb108-2" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb108-3"><a href="exponential.html#cb108-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sigma =</span> <span class="fu">map_dbl</span>(value, <span class="sc">~</span><span class="fu">unlist</span>(.) <span class="sc">%&gt;%</span> .[<span class="st">&quot;mu&quot;</span>]),</span>
<span id="cb108-4"><a href="exponential.html#cb108-4" tabindex="-1"></a>         <span class="at">ci_025 =</span> <span class="fu">qnorm</span>(.<span class="dv">025</span>, .mean, sigma),</span>
<span id="cb108-5"><a href="exponential.html#cb108-5" tabindex="-1"></a>         <span class="at">ci_975 =</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, .mean, sigma))</span>
<span id="cb108-6"><a href="exponential.html#cb108-6" tabindex="-1"></a></span>
<span id="cb108-7"><a href="exponential.html#cb108-7" tabindex="-1"></a>www_fit <span class="sc">%&gt;%</span></span>
<span id="cb108-8"><a href="exponential.html#cb108-8" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb108-9"><a href="exponential.html#cb108-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> index)) <span class="sc">+</span></span>
<span id="cb108-10"><a href="exponential.html#cb108-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb108-11"><a href="exponential.html#cb108-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-12"><a href="exponential.html#cb108-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> www_fc, <span class="fu">aes</span>(<span class="at">y =</span> .mean), <span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-13"><a href="exponential.html#cb108-13" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> www_fc, <span class="fu">aes</span>(<span class="at">ymin =</span> ci_025, <span class="at">ymax =</span> ci_975), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-14"><a href="exponential.html#cb108-14" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb108-15"><a href="exponential.html#cb108-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Internet usage by Minute.&quot;</span>, </span>
<span id="cb108-16"><a href="exponential.html#cb108-16" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Holt&#39;s method with damping. Shaded are is 95% prediction interval.&quot;</span>,</span>
<span id="cb108-17"><a href="exponential.html#cb108-17" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<pre><code>## Warning: The output of `fortify(&lt;fable&gt;)` has changed to better suit usage with the ggdist package.
## If you&#39;re using it to extract intervals, consider using `hilo()` to compute intervals, and `unpack_hilo()` to obtain values.
## The output of `fortify(&lt;fable&gt;)` has changed to better suit usage with the ggdist package.
## If you&#39;re using it to extract intervals, consider using `hilo()` to compute intervals, and `unpack_hilo()` to obtain values.</code></pre>
<p><img src="time-series_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
</div>
<div id="model-selection-via-maximum-likelihood" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Model Selection via Maximum Likelihood<a href="exponential.html#model-selection-via-maximum-likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you specify an ETS model with no parameters, it will use maximum likelihood to select the model with the minimum AIC<sub>c</sub>. Try it with the internet usage data set.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="exponential.html#cb110-1" tabindex="-1"></a>ets_mdl <span class="ot">&lt;-</span> datasets<span class="sc">::</span>WWWusage <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="exponential.html#cb110-2" tabindex="-1"></a>  <span class="fu">as_tsibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="exponential.html#cb110-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(value))</span>
<span id="cb110-4"><a href="exponential.html#cb110-4" tabindex="-1"></a></span>
<span id="cb110-5"><a href="exponential.html#cb110-5" tabindex="-1"></a>ets_mdl <span class="sc">%&gt;%</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: value 
## Model: ETS(A,Ad,N) 
##   Smoothing parameters:
##     alpha = 0.9999 
##     beta  = 0.9966439 
##     phi   = 0.814958 
## 
##   Initial states:
##      l[0]        b[0]
##  90.35177 -0.01728234
## 
##   sigma^2:  12.2244
## 
##      AIC     AICc      BIC 
## 717.7310 718.6342 733.3620</code></pre>
<p>ETS chose an additive damped trend model, the same as we found using cross validation.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="arima.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["time-series.pdf", "time-series.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
